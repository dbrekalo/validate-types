!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).validateTypes=t()}(this,(function(){"use strict";function e(e,t){var n=!1,r=typeof e,a=function(e){n=r===e};switch(t){case String:a("string");break;case Number:a("number");break;case Boolean:a("boolean");break;case Function:a("function");break;case Array:n=Array.isArray(e);break;case Object:n="object"===r&&null!==e&&!Array.isArray(e);break;default:n=e instanceof t}return n}var t=function(e,t){for(var n=0,r=e.length;n<r&&!1!==t(e[n],n);n++);},n=function(e){return!0===Boolean(e)&&"object"==typeof e&&e.constructor===Object},r=function(e,t){return Object.keys(t).forEach((function(n){e[n]=t[n]})),e},a=[{name:"required",validate:function(e){return!e.testConfig||void 0!==e.fieldValue},message:function(e){return'Field "'+e.fieldName+'" is required'},skipFurtherTests:function(e){return!e.validateResult},testUndefinedValues:!0},{name:"type",validate:function(t){return function(t,n){if(Array.isArray(n)){for(var r=!1,a=0,i=n.length;a<i;a++)if(e(t,n[a])){r=!0;break}return r}return e(t,n)}(t.fieldValue,t.testConfig)},message:function(e){return'Field "'+e.fieldName+'" is of invalid type'},skipFurtherTests:function(e){return!e.validateResult}},{name:"validator",validate:function(e){return Boolean(e.testConfig(e.fieldValue))},message:function(e){return'Field "'+e.fieldName+'" failed validation'}}];return function e(i){var s=[],o={},u=function(e,r,a){var i={},o=[],f={};r=r||{},a=a||{};return Object.keys(e).forEach((function(f){var c=e[f];!function(n,f){var c=!1===a.assignDefaults?void 0:"function"==typeof f.default?f.default():f.default,d=void 0!==r[n]?r[n]:c,l=void 0===d;l||(i[n]=d),t(s,(function(t){var i=f[t.name];if(void 0!==i&&(!l||t.testUndefinedValues)){var s={fieldValue:d,fieldName:n,fieldSchema:f,testConfig:i,input:r,schema:e,validator:u};if(!(s.validateResult=t.validate(s))){var c=a.messages&&a.messages[n]&&a.messages[n][t.name]||t.message;o.push({field:n,test:t.name,message:"function"==typeof c?c(s):c})}return(!t.skipFurtherTests||!t.skipFurtherTests(s))&&void 0}}))}(f,n(c)?c:{type:c})})),Object.keys(r).forEach((function(t){e[t]||(f[t]=r[t])})),{hasErrors:o.length>0,hasUndeclaredFields:Object.keys(f).length>0,errors:o,data:i,undeclaredFields:f}};return u.addTest=function(e,n){var a=r({},e),i=n&&(n.insertAfter||n.insertBefore);if(i){var f=-1;if(t(s,(function(e,t){if(e.name===i)return f=t,!1})),!(f>=0))throw new Error('Test "'+i+'" not found');s.splice(n.insertAfter?f+1:f,0,a)}else s.push(a);return o[a.name]=a,u},u.removeTest=function(e){return delete o[e],s=s.filter((function(t){return t.name!==e})),u},u.getTest=function(e,t){var n=o[e];return n?t?n:r({},n):void 0},u.setTestMessage=function(e,t){return u.getTest(e,!0).message=t,u},u.validateValue=function(e,t){var n=u({field:t},{field:e});return{hasErrors:n.hasErrors,errors:n.errors.map((function(e){return{test:e.test}}))}},u.extractDefaults=function(e){var t={};return Object.keys(e).forEach((function(r){var a=e[r],i=n(a)?a.default:void 0,s=typeof i;if("undefined"!==s){var o="function"===s?i():i;void 0!==o&&(t[r]=o)}})),t},u.clone=function(){return e(s)},u.createValidator=e,(i||a).forEach((function(e){u.addTest(e)})),u}()}));
